<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>단어 상세</title>
    <style>
        :root {
            --primary: #0C4DA1;
            --accent: #00A295;
            --border: #e5e7eb;
            --text: #1f2937;
            --muted: #6b7280;
        }
        * { box-sizing: border-box; }
        body { margin: 0; font-family: 'Noto Sans KR', sans-serif; background: #f3f4f6; color: var(--text); }
        header { background: linear-gradient(135deg, #0C4DA1, #00A295); color: #fff; padding: 22px; text-align: center; box-shadow: 0 6px 20px rgba(0,0,0,0.12); }
        header h1 { margin: 0; font-size: 24px; }
        .container { max-width: 980px; margin: -32px auto 40px; padding: 0 18px; }
        .grid { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; }
        @media (max-width: 920px) { .grid { grid-template-columns: 1fr; } }
        .card { background: #fff; border-radius: 16px; padding: 22px; box-shadow: 0 12px 28px rgba(0,0,0,0.08); position: relative; }
        .badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; background: #e8f1ff; color: var(--primary); border-radius: 10px; font-weight: 700; }
        .word { font-size: 40px; margin: 10px 0 4px; color: var(--text); }
        .doc { color: var(--muted); font-size: 18px; margin-bottom: 18px; }
        .meaning { font-size: 18px; font-weight: 600; }
        .meta { margin-top: 10px; color: var(--muted); font-size: 14px; }
        .bookmark-btn { position: absolute; top: 18px; right: 18px; border: none; background: none; font-size: 26px; cursor: pointer; color: #fbbf24; }
        .bookmark-btn.inactive { color: #d1d5db; }
        .actions { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 18px; }
        .btn { padding: 10px 14px; border-radius: 10px; text-decoration: none; border: 1px solid var(--border); color: var(--text); background: #fff; }
        .btn.primary { background: var(--primary); color: #fff; border: none; box-shadow: 0 10px 20px rgba(12,77,161,0.2); }
        .btn.accent { background: var(--accent); color: #fff; border: none; box-shadow: 0 10px 20px rgba(0,162,149,0.18); }
        .form-group { margin-bottom: 12px; }
        .form-group label { display: block; color: var(--muted); margin-bottom: 6px; font-size: 13px; }
        .form-group input, .form-group select { width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid var(--border); }
        .section-title { margin: 0 0 12px; font-size: 18px; }
        .alert { margin-bottom: 12px; padding: 12px 14px; background: #ecfeff; color: #0f766e; border: 1px solid #99f6e4; border-radius: 10px; }
    </style>
</head>
<body>
    <header>
        <h1>단어 상세 정보</h1>
    </header>

    <div class="container">
        <div class="grid">
            <section class="card" th:if="${word != null}">
                <div class="badge" th:text="${word.jlpt}">N5</div>
                <form th:action="@{'/word/' + ${word.wordId} + '/bookmark'}" method="post" style="margin:0;">
                    <input type="hidden" name="user" th:value="${user}">
                    <button type="submit" class="bookmark-btn" th:classappend="${bookmarked} ? '' : ' inactive'" th:title="${bookmarked} ? '즐겨찾기 해제' : '즐겨찾기 추가'}">
                        <span th:text="${bookmarked} ? '★' : '☆'"></span>
                    </button>
                </form>

                <div class="word" th:text="${word.word}"></div>
                <div class="doc" th:text="${word.doc}"></div>
                <div class="meaning" th:text="${word.korean}"></div>
                <div class="meta" th:text="${word.updatedAt != null ? '수정: ' + #temporals.format(word.updatedAt, 'yyyy.MM.dd HH:mm') : ''}"></div>

                <div class="actions">
                    <a class="btn" th:href="${from != null} ? @{/word(query=${from}, user=${user})} : @{/word(user=${user})}">⬅ 검색으로 돌아가기</a>
                    <a class="btn" th:href="@{/word/bookmarks(user=${user})}">내 즐겨찾기</a>
                    <a class="btn primary" th:href="@{/word}">새 검색</a>
                </div>
            </section>

            <section class="card">
                <h3 class="section-title">정보 수정 신청</h3>
                <div th:if="${msg}" class="alert" th:text="${msg}"></div>
                <form th:if="${requestForm != null}" th:action="@{/word/requests/edit}" method="post" th:object="${requestForm}">
                    <input type="hidden" th:field="*{wordId}">
                    <input type="hidden" th:field="*{requestedBy}" th:value="${requestForm.requestedBy}">
                    <div class="form-group">
                        <label for="wordInput">단어</label>
                        <input id="wordInput" type="text" th:field="*{word}" required>
                    </div>
                    <div class="form-group">
                        <label for="docInput">요미가나</label>
                        <input id="docInput" type="text" th:field="*{doc}" required>
                    </div>
                    <div class="form-group">
                        <label for="koreanInput">뜻</label>
                        <input id="koreanInput" type="text" th:field="*{korean}" required>
                    </div>
                    <div class="form-group">
                        <label for="jlptInput">JLPT</label>
                        <select id="jlptInput" th:field="*{jlpt}" required>
                            <option value="N5">N5</option>
                            <option value="N4">N4</option>
                            <option value="N3">N3</option>
                            <option value="N2">N2</option>
                            <option value="N1">N1</option>
                            <option value="기타">기타</option>
                        </select>
                    </div>
                    <button class="btn accent" type="submit" style="width:100%;">수정 요청 제출</button>
                </form>
            </section>
        </div>
    </div>
</body>
</html>