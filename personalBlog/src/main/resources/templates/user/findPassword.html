<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

<header class="blog-header" onclick="location.href='/'" style="cursor: pointer;">
    <h1 class="blog-title">My Coding Life</h1>
    <p class="blog-subtitle">ì†Œì†Œí•œ ì¼ìƒê³¼ ê°œë°œ ê¸°ë¡ì„ ë‚¨ê¸°ëŠ” ê³µê°„</p>
</header>

<nav class="navbar navbar-expand-lg blog-nav">
    <div class="container">
        <a class="navbar-brand fw-bold" href="/" style="font-size: 0.9rem; color: #555;">Home</a>
        <div class="ms-auto">
             <a class="nav-link d-inline-block" href="/auth/joinForm">íšŒì›ê°€ì…</a>
        </div>
    </div>
</nav>

<div class="container main-box" style="max-width: 500px; margin-top: 50px;">
    <div class="login-card">
        
        <div class="text-center mb-4">
            <h3 class="fw-bold" style="color: #4a4a4a;">ğŸ”’ ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</h3>
            <p class="text-muted small">ê°€ì… ì‹œ ë“±ë¡í•œ ì•„ì´ë””ì™€ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
        </div>

        <form>
            <div class="mb-3">
                <label class="form-label fw-bold small">ì•„ì´ë””</label>
                <input type="text" id="username" class="form-control" placeholder="ì•„ì´ë”” ì…ë ¥">
            </div>

            <div class="mb-4">
                <label class="form-label fw-bold small">ì „í™”ë²ˆí˜¸</label>
                <input type="text" id="phoneNumber" class="form-control" placeholder="ì „í™”ë²ˆí˜¸ ì…ë ¥ (ì˜ˆ: 01012345678)">
            </div>

            <div class="d-grid gap-2">
                <button type="button" onclick="findPw()" class="btn btn-brown">ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ë°œê¸‰</button>
                <a href="/auth/loginForm" class="btn btn-outline-secondary rounded-pill py-2">ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
            </div>
        </form>
        
        <div id="result-box" class="alert alert-success mt-4 d-none text-center">
            <p class="mb-1 small">ì„ì‹œ ë¹„ë°€ë²ˆí˜¸:</p>
            <h4 class="fw-bold text-danger" id="temp-pw-text"></h4>
            <p class="mb-0 small text-muted">ë¡œê·¸ì¸ í›„ ë°˜ë“œì‹œ ë³€ê²½í•˜ì„¸ìš”!</p>
        </div>

    </div>
</div>

<script>
    function findPw() {
        let data = {
            username: $("#username").val(),
            phoneNumber: $("#phoneNumber").val()
        };

        if(!data.username || !data.phoneNumber) {
            alert("ì•„ì´ë””ì™€ ì „í™”ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        $.ajax({
            type: "POST",
            url: "/auth/reset-password",
            data: JSON.stringify(data),
            contentType: "application/json; charset=utf-8",
            dataType: "json"
        }).done(function(resp) {
            $("#result-box").removeClass("d-none");
            $("#temp-pw-text").text(resp.data);
            alert("ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ê°€ ë°œê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }).fail(function(error) {
            // ì„œë²„ì—ì„œ ë³´ë‚¸ ì—ëŸ¬ ë©”ì‹œì§€ í™œìš©
            if(error.responseJSON && error.responseJSON.data) {
                alert(error.responseJSON.data);
            } else {
                alert("ì •ë³´ê°€ ì¼ì¹˜í•˜ì§€ ì•Šê±°ë‚˜ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íšŒì›ì…ë‹ˆë‹¤.");
            }
        });
    }
</script>

</body>
</html>